title: Possible Confluence RCE [CVE-2022-26134] Exploitation Attempt (via web)
id: a9814b4e-1541-4b7e-b1b3-4e5d9dccc379
status: stable
description: Detects possible exploitation attempt of Confluence Server/Data Center, based on public available exploit PoC code.
references:
    - https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134/
    - https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html
    - https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/
    - https://github.com/jbaines-r7/through_the_wire
author: SOC Prime Team
tags:
    - attack.initial_access
    - attack.t1190
logsource:
    category: webserver
detection:
    selection_base:
        c-uri|contains:
            - '%24%7B'
            - '$%7B'
            - '${'
    selection_chains:
        - c-uri|contains|all:
            - 'ScriptEngineManager' #ex.:%24%7Bnew%20javax.script.ScriptEngineManager%28%29.getEngineByName%28%22
            - 'getEngineByName'
            - 'javax'
        - c-uri|contains|all:
            - 'Runtime'
            - 'java'
            - '.exec' #[02/Jun/2022:16:02:13 -0700] - http-nio-8090-exec-10 10.0.0.28 GET /%24%7B%40java.lang.Runtime%40getRuntime%28%29.exec%28%22touch%20/tmp/r7%22%29%7D/ HTTP/1.1 302 20ms - - curl/7.68.0
    condition: selection_base and selection_chains
falsepositives:
    - Unknown
level: high