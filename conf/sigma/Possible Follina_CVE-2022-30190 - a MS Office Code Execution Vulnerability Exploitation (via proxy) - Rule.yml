title: Possible Follina/CVE-2022-30190 - a MS Office Code Execution Vulnerability Exploitation (via proxy)
id: d3e8c1a0-ef9d-4d9e-865e-928cac19eca3
status: stable
description: Microsoft Office Existence Discovery is a user-agent, which may appear when opening documents from an url location.
references:
    - https://twitter.com/malmoeb/status/1530994932508401664
    - https://docs.microsoft.com/en-gb/archive/blogs/vsofficedeveloper/description-of-the-microsoft-office-existence-discovery-protocol-2
    - https://www.bleepingcomputer.com/news/security/new-microsoft-office-zero-day-used-in-attacks-to-execute-powershell/
    - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
    - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
    - https://twitter.com/nao_sec/status/1530196847679401984
    - https://blog.syss.com/posts/abusing-ms-office-protos/
    - https://research.checkpoint.com/2023/behind-the-scenes-of-bbtok-analyzing-a-bankers-server-side-components/
author: SOC Prime Team
tags:
    - attack.defense_evasion
    - attack.t1221
logsource:
    category: proxy
detection:
    selection:
        c-useragent|contains|all:
            - 'Microsoft' #User-Agent - Microsoft Office Existence Discovery
            - 'Office'
            - 'Existence'
            - 'Discovery'
    condition: selection
falsepositives:
    - Unknown
level: medium