title: Possible Follina/CVE-2022-30190 - a MS Office Code Execution Vulnerability Exploitation (via file_event)
id: a996524f-c8c0-40d1-8641-0e9bb0a50bba
status: stable
description: Possible abuse of ms-msdt MSProtocol URI scheme to load and execute malicious code. That file will contain possible traces of exploitation process.
author: SOC Prime Team
references:
    - https://twitter.com/nas_bench/status/1531718490494844928
    - https://twitter.com/wdormann/status/1532052784748560384
    - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
    - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
    - https://twitter.com/nao_sec/status/1530196847679401984
    - https://blog.syss.com/posts/abusing-ms-office-protos/
    - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-30190
    - https://gist.github.com/Samirbous/9384ee6667f8b472ee6d9dcd505bd175
tags:
    - attack.defense_evasion
    - attack.t1218
logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|contains|all:
            - 'Diagnostics' #%localappdata%\Diagnostics\PCW.debugreport.xml
            - 'PCW.debugreport.xml'
    condition: selection
falsepositives:
    - Legitimate usage of MSDT (Microsoft Diagnostics Tool)
level: low