title: Possible Follina/CVE-2022-30190 - a MS Office Code Execution Vulnerability Exploitation (via Diagnosis-Scripted provider)
id: 6419dc6c-bbb1-4695-bf0e-0cb0fe4c1aca
status: stable
description: Possible abuse of ms-msdt MSProtocol URI scheme to load and execute malicious code.
author: SOC Prime Team, SBousseaden
references:
    - https://pbs.twimg.com/media/FUCL-zuXsAAcCxY?format=png&name=large
    - https://twitter.com/SBousseaden/status/1531378470135205906
    - https://twitter.com/SecurityAura/status/1531338505170853889
    - https://twitter.com/Max_Mal_/status/1438146033406599169
    - https://github.com/JohnHammond/msdt-follina
    - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
    - https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/
    - https://twitter.com/nao_sec/status/1530196847679401984
    - https://blog.syss.com/posts/abusing-ms-office-protos/
tags:
    - attack.defense_evasion
    - attack.t1221
logsource:
    product: windows
    service: diagnosis-scripted-operational
    definition: mapping Provider_Name 'Microsoft-Windows-Diagnosis-Scripted/Operational'
detection:
    selection:
        EventID: 105
    keywords:
        - 'RS_IncompatibleApplication_ID'
    condition: selection and keywords
falsepositives:
    - Unknown
level: low