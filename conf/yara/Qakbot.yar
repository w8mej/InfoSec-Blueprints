import "vt"

rule Qakbot2020September
{
  meta:
    author="Kevin Beaumont"
    
  strings:
    $0 = {04B88B8B4A4361B79BBBE64DB3E12AEC04A8938B8BFB5C459742638B525BDDC193E422F0A4014DC0144733C35320A4CC4B20A4CCDAE083837B9C994547A0994536BD994535CB994564C8994563A099455AC3994551CA994548DA99452FCB99452EDA99452DD39945ECA69945EBD39945F2AA9945E96B9945F7C09945F6C69945E5D99945E4BD9945BBC69945B2BF9945A9989945A09999459F7D99459EC799459DBF99}
    $1 = {12FC9FBE478BCA4705C09C6E1AF8DFF622D0BEF62A0814ED57038F6B90D004B8938BE273E68415835C008F56A78B2AA89CCC5B37A4CC5337A4CC4B37A4CCBAF68383FB669945F7A09945E6D39945E5BC9945F4BE9945F3BF9945EACB9945E1D69945B8AB9945BFD69945BED69945BDD999459C}
    $2 = {A693834E6AE64D4BE42AFC90015E854FBF5DEB24E41AFC74AE678B2A969CCC4B27A4CCBAE48383FB8AE44597E21AE004A67F8B5A4B5D51ABE22AE414AE7B8B47B35C4D87E222F8149E978B4D8F5C4587E21AE804A6978B3E8B5C5597E22AF004AE}
    $3 = {28A4CCBAE48351D0AE93008F6B5FEB86E41AFC0C2C5C895237E54DE374220C5C89E455876C2AFC146E5C45C3E422088CA693898EE42AFC0E2E0FA9976BE445876C1AFC5C5BE44D976C22FC165A84C1044E33C3DAE4}
    $4 = {85E4407FF2220871F42708CA2AA4CC5338A4CC4B38A4CCBAF28383FB73E44597F41AF8D0B093008F6B5FEB96F222FC0C2D5F894A47E555D3822A103C78E445C76A1AFC05B9638887527E8BB2A89CCCD337}
    $5 = {FC8835E74D7FE1EA907B35918BCA3B5D42ABE21AF014A78F890ABC93FF50E1EA704B35910FF8A9698912F093FF30E1E2702B35918BFADB93FF18692E2806DFE3FC0835E5}
    $6 = {42851DA75FC34B20A4CCBAE283833B9C994567A7994556C9994555D8994544BC994543DA99453ABF994531CB9945E8AC9945EFC79945EEC79945EDD99945ECC89945EB}
    $7 = {008FC15F8D0AB393FF589B879D583691835367E4458BE41AF804B067890AC793FF28E4C2782336918D0AB393FF109C874903369183CB6E8741FC3591890ACF93FFE8}
    $8 = {03CA5BE44D87F02A0C8C5AE44D47F25B0A3412E55587F01A088CA95B89D273866B2044918B32A69CCCBAF08383FB8EE44593F21AE404B67B8B5A4F5D51ABF22A}
    $9 = {00756BE445879B9055F7F37A5DCC36A4CCD336A4CCCB36A4CC3AF4835114AE6350B71B92FFB8EB9B0406AE93832A4760747BF4220C3EF42A083DF41AFCDF530A}
  condition:
    vt.metadata.new_file and all of them
}

rule Qakbotty
{
  meta:
    author="Kevin Beaumont"
    
  strings:
    $0 = {D5A800D3EACB00DAF0D200D6EECD00D1EDC700CAE9C000C3E7B700BCE4AF00B5E1A600AFDF9D00A5DB910089C27300D7EDD000A9DC9800DDF1D400CAE2C100C6E0BC00BADBAE00B6D9A800AFD7A000A7D49600A2D28F0096CD83007DB56800E3ECDF00D8EED000D3EDCA00CFEBC500C3E7B600BDE4AF00AEDE9E00A9DD95009AD486008BC47700FDFEFD00C3DFB900BEDDB200B8DAAC00B3D8A600ADD69E00A1D18F0097CE85008FC57A008EBF7B00EEF1EE00C1E6B600CAEAC100C6E8BA00C1E6B300B9E3AB00B3E0A400AFDF9C00A6DB93009DD8}
    $1 = {00CEE7C900C7E5C000C5E4BE00C3E3BB00BCE1B300B9E1B000B7E0AD00B0DEA600ADDDA300ABDDA000A4DB9800A2DA95009FDA9300B7B7B700C9C9C900D2E8CD00D1E7CB00CCE6C600CAE5C300C0E3B900BEE2B600B4DFAB00B2DFA800A9DC9D00A6DB9B009DD99000B8B8B800CACACA00D4E8CF00D3E8CE00BCBC}
    $2 = {00AED1A100A7DC9400C5E8BA00C2E6B600BDE4AE00B7E2A700B0E09F00A9DC9700A2DA8F009DD8870094D47D008DC57700D4EACB00A9D59900A3D292009ED18B0099CE860090CB7D007FB66A00DDE9D90097D684009CD88900A4DB9100A4DB9000A3DA9000A1DA8E00A1D98E00A5DB9200A2D9}
    $3 = {00889A7F00BCE4AE004B564600D2ECC8004A534500CBE9BE00BFE5B100B5E1A4009FD58C009FD08D00ACACAC00A8DC9700E3F3DC00DEF1D700D9EFD000D3EDC900CCEBC100C5E8B800BEE5AF00B5E1A500AEDE9D0097CE84009DCF8B008080}
    $4 = {000E5558377AA99E000F558337CA999E000F2258377CA99E000F22258337CAAE000F662258377CCE000FBB622583377E000D44662258333E000D444B6225833F000D1144B622588F000D11144B62279F000D111144B66FFF00}
    $5 = {00B4E1A500E0F1DA00DEF1D500D8EECE00D1ECC600CAE9BE00C2E6B500BBE3AD00B2E0A300ADDD9A0094CB8000ADD79D00D0ECC500CBEAC000CFE3C800CBE2C300C7E0BE00C1DEB600BBDBAF00B4D8A700}
    $6 = {00CEE6C800CBE6C500C1E3B900B7E0AD00ABDDA000A1DA9400D1E7CC00CFE7C900C8E5C100C4E4BD00BEE2B500BAE1B100B3DFA900B0DEA500A8DC9C00A4DB98009DD99000D5E8D000D2E8CD00CECECE00}
    $7 = {325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA325300EA}
  condition:
    vt.metadata.new_file and all of them
}

rule Qakkers
{
  meta:
    author="Kevin Beaumont"
    
  strings:
    $0 = {5A170D3339313233313233353935395A301D311B301906035504031312}
    $1 = {0203010001A367306530130603551D25040C300A06082B06010505070303304E0603551D01044730458010}
    $2 = {CCCCCCCCCCCCCCCC558BEC83EC088B45088945FC8B4D0C894DF88B55FC3B55F873078B45FCEB05EB038B45F88BE55DC3}
    $3 = {000047444933322E646C6C005E025265674F70656E4B657957006702526567517565727956616C75654578410000}
    $4 = {00004101466C75736846696C65427566666572730000AD0147657443757272656E7454687265616449640000}
    $5 = {005553455233322E646C6C0000BB01476574456E684D65746146696C65426974730000}
    $6 = {30819F300D06092A864886F70D010101050003818D0030818902818100}
    $7 = {00F6024C6F61645265736F75726365000007034C6F636B5265736F757263650000}
    $8 = {003E014765744D656E75436865636B4D61726B44696D656E73696F6E730000}
    $9 = {300906052B0E03021D0500301D311B301906035504031312}
    $10 = {00001504536574556E68616E646C6564457863657074696F6E46696C74657200}
    $11 = {004B45524E454C33322E646C6C0000D6014C6F616449636F6E4100}
    $12 = {0201013031301D311B301906035504031312}
    $13 = {001A034D756C746942797465546F576964654368617200}
    $14 = {00640457616974466F7253696E676C654F626A65637400}
    $15 = {4100F4014765744D6F64756C6546696C654E616D65410000}
    $16 = {0000A90044697370617463684D657373616765570000}
    $17 = {00450247657453797374656D4469726563746F72794100}
    $18 = {00F5014765744D6F64756C6546696C654E616D65570000}
    $19 = {570036025265676973746572436C617373570000}
    $20 = {0055045669727475616C416C6C6F6345780000}
    $21 = {00AA0147657443757272656E7450726F63657373496400}
    $22 = {0000960044656657696E646F7750726F63570000}
    $23 = {476574456E684D65746146696C6542697473}
  condition:
    vt.metadata.new_file and all of them
}
